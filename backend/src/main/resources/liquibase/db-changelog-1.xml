<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd">
    <changeSet author="generator" id="1">
        <!--CREATE TABLES-->
        <createTable tableName="Student">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="ime" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="prezime" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="index" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="trenutnoStanjeRacuna" type="DECIMAL(10, 4)">
                <constraints nullable="false"/>
            </column>
            <column name="budzet" type="BOOLEAN">
                <constraints nullable="false"/>
            </column>
            <column name="tekuciSemestar" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="osvojeniBodovi" type="INT">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createTable tableName="Predmet">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="naziv" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="espb" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="obavezni" type="BOOLEAN">
                <constraints nullable="false"/>
            </column>
            <column name="predlozeniSemestar" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="imeProfesora" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createTable tableName="Stanje">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="iznos" type="DECIMAL(10, 4)">
                <constraints nullable="false"/>
            </column>
            <column name="datum" type="DATETIME">
                <constraints nullable="false"/>
            </column>
            <column name="studentId" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createTable tableName="Rok">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="godina" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="naziv" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createTable tableName="StudPred">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="studentId" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="predmetId" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createTable tableName="Prijava">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="rokId" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="studPredId" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <!--ADD FOREIGN KEYS-->
        <addForeignKeyConstraint baseColumnNames="studentId" baseTableName="Stanje" constraintName="FK_STA.S_STU.I_A0FACF" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="Student"/>
        <addForeignKeyConstraint baseColumnNames="studentId" baseTableName="StudPred" constraintName="FK_STU_PRE.S_STU.I_D34777" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="Student"/>
        <addForeignKeyConstraint baseColumnNames="predmetId" baseTableName="StudPred" constraintName="FK_STU_PRE.P_PRE.I_9E39C0" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="Predmet"/>
        <addForeignKeyConstraint baseColumnNames="rokId" baseTableName="Prijava" constraintName="FK_PRI.R_ROK.I_FB78B3" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="Rok"/>
        <addForeignKeyConstraint baseColumnNames="studPredId" baseTableName="Prijava" constraintName="FK_PRI.SP_STU_PRE.I_2508C3" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="StudPred"/>
        <!--ADD UNIQUE CONSTRAINTS-->
        <addUniqueConstraint columnNames="index" constraintName="UNQ_STU_I_76BEE7" tableName="Student"/>
    </changeSet>
</databaseChangeLog>
